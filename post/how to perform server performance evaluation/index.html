
<!DOCTYPE html>
<html lang="">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" 怎样尽可能全面的评估一台服务器的性能 &middot;  BG2BKK Site" />
        <meta property="og:site_name" content="BG2BKK Site" />
        <meta property="og:url" content="https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2016-10-23T16:43:44&#43;08:00" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:creator" content="@" />
        <meta name="twitter:title" content="怎样尽可能全面的评估一台服务器的性能" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:url" content="https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" />
    

        <title> 怎样尽可能全面的评估一台服务器的性能 &middot;  BG2BKK Site</title>

    
        <meta name="description" content="" />
    
        
        <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
          

    
        <link href="https://bg2bkk.github.io/index.xml" rel="alternate" type="application/rss+xml" title="BG2BKK Site" />
    

    
        <link rel="canonical" href="https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" />

    
    <script type="application/ld+json">
    { 
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "怎样尽可能全面的评估一台服务器的性能",
        "author": {
            "@type": "Person",
            "name": "http://profiles.google.com/?rel=author"
        },
        "datePublished": "2016-10-23",
        "description": "",
        "wordCount":  556 
    }
    </script>
    
    
    <style>
*{padding:0;margin:0}body,html{font-size:1em;line-height:1.65em;font-family:"Open Sans",sans-serif;font-weight:300;color:#444}html{height:100%}body{padding:2em 2.5em 1em 20em}header{border-right:1px #eee solid;padding:2em;position:fixed;top:0;left:0;height:100%;width:13.5em}#content{display:block;width:100%}footer{padding:1em 0 2.5em;font-size:.8em;line-height:1.5em;color:#888}article{border-bottom:.1em #eee solid;padding-bottom:1.7em;max-width:56em}h4,h5,h6,hr,p{margin-top:.9em;margin-bottom:.9em}h1,h2,h3,h4,h5,h6{font-family:"Microsoft Yahei",serif;font-weight:400!important}h1{font-size:2.5em;line-height:1.1em;margin-top:.6em;margin-bottom:.6em}h2{font-size:1.9em;line-height:1.2em;margin-top:.7em;margin-bottom:.7em}h3{font-size:1.4em;line-height:1.3em;margin-top:.8em;margin-bottom:.8em}h4{font-size:1.3em}h5{font-size:1.2em}h6{font-size:1.1em}iframe,img{max-width:100%}a{font-weight:700;text-decoration:none;color:#5cc265}a:hover{text-decoration:underline}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:400!important}strong{font-weight:700}blockquote{border-left:.4em solid #eee;padding-left:1.2em;font-size:1.3em}hr{border:0;height:1px;background:#eee}ol,ul{margin-left:3em}code{font-size:1.4em;background:#eee}pre{font-size:.8em;line-height:2em;background:#eee;padding:1em;word-break:break-all;word-wrap:break-word;white-space:pre;white-space:-moz-pre-wrap;white-space:pre-wrap}input{font-size:1em;padding:.3em}header h1{font-size:1.9em;margin-top:.8em;margin-bottom:.6em}header h1 a{color:#444}header h1 a:hover{text-decoration:none}header #logo img{width:9em;height:9em;border-radius:4.5em;-moz-border-radius:4.5em;-webkit-border-radius:4.5em;border:none}#follow-icons{font-size:.7em;margin-top:-.7em;margin-bottom:1.5em}#follow-icons a{color:#ccc}#follow-icons span{vertical-align:top;margin-left:-.15em;margin-right:-.15em}#follow-icons span .fa-stack-1x{font-size:1.05em;line-height:1.9em}header h6{margin-top:.5em}article span.post-stamp{color:#888}h1.post-title{margin-top:.35em;margin-bottom:.6em}h3.post-title{margin-top:.4em;padding-bottom:.9em;border-bottom:1px solid #eee;font-size:1.2em;color:#444}.post-title time{font-size:0.5em}.post-title a{color:#494949;font-family:"Bree Serif",serif;}.post-title .feature-star{font-size:.9em}.feature-star,.separator,.taglist{color:#ccc}.taglist a{background-color:#ccc;color:#fff;display:inline-block;line-height:1.5em;padding:.3em .6em;vertical-align:20%;font-size:.5em;font-family:"Open Sans",sans-serif;font-weight:700!important;text-transform:uppercase;letter-spacing:.05em;border-radius:.25em;-moz-border-radius:.25em;-webkit-border-radius:.25em}#social-bar{margin-top:1.5em;background-color:#eee;padding:.5em}#comments{margin-top:.15em;padding-bottom:.2em;border-bottom:1px solid #eee}.pagination{margin-bottom:1em}footer a{font-weight:300;color:#888;text-decoration:underline}footer a:hover{color:#444;text-decoration:none}@media only screen and (min-width:1281px){body,html{font-size:1.1em}}@media only screen and (max-width:800px){body{padding:0}header{border-right:none;border-bottom:1px #eee solid;position:relative;height:auto;width:auto;text-align:center;padding-bottom:1em}#content{margin-left:0;padding:2em 2em 1em;width:auto}footer{padding:0 2.5em 2em}}@media only screen and (max-width:320px){#content,header{padding:1.2em 1.2em .6em}footer{padding:0 1.5em 1.2em}ol,ul{margin-left:2em}}
</style>

    </head>
    <body>
        <header id="header">
            
            <a id="logo" href="https://bg2bkk.github.io/"><img src="https://raw.githubusercontent.com/BG2BKK/githubio/master/themes/crisp/images/eagle.jpg" alt="BG2BKK Site" /></a> 
            <h1><a href="https://bg2bkk.github.io/">BG2BKK Site</a></h1>
            <p></p>

            <div id="follow-icons">
	<a href="http://facebook.com/bg2bkk" rel="me"><i class="fa fa-facebook-square fa-2x"></i></a>
	<a href="http://twitter.com/bg2bkk1" rel="me"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="http://github.com/bg2bkk" rel="me"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://github.com/bg2bkk" rel="me"><i class="fa fa-github-square fa-2x"></i></a>
	<a href="http://plus.google.com/bg2bkk" rel="author"><i class="fa fa-google-plus-square fa-2x"></i></a>
	<a href="https://bg2bkk.github.io/index.xml" rel="me"><i class="fa fa-rss-square fa-2x"></i></a> 
</div>  

            <h6><a href="https://bg2bkk.github.io/post/resume/">About</a></h6>

        </header>

<main id="content">

<article id="" class="post">
    <div class="post-stamp">
        <time datetime="2016-10-23T16:43:44&#43;08:00">
            23 Oct 2016
        </time>
        <span class="taglist">
        
        </span>
    </div>
    <h1 class="post-title">怎样尽可能全面的评估一台服务器的性能</h1>
    

<p>给你一台服务器，怎样能够全面评估它的性能？需要测试哪些指标？请写出每个指标的具体测试原理和测试代码。假设这台服务器完全处于线下。</p>

<p>这个问题看似平常，但是细细审题的话，发现还是不一样的。我们过多关注线上机器的性能，但是如果单独拿出来一台服务器，它的性能怎样呢？</p>

<p>评估和压榨一台服务器性能的话，找到评估的指标，然后进行压测加观察的方式，得到性能参数。</p>

<ol>
<li>观察哪些指标，意义何在？</li>
<li>如何观察这些指标，测试原理，观测工具/统计代码</li>
<li>如何进行压测，实现测试场景，压测工具/压测代码</li>
</ol>

<p>bench可以分类为macro bench和micro bench;对于macro bench，很多时候我们得到的是一个整体而粗略的结果，通过top我们可以看到系统负载，这些对于我们定位线上问题，分析应用程序的性能热点很有帮助，然而这并不能精确衡量一台Linux Server的性能；应用程序多种多样，线上系统目的各不相同，所以macro bench一般用于case by case的性能分析，<a href="https://github.com/BG2BKK/githubio/blob/master/content/post/macrobench.md">用于解决应用的性能瓶颈</a>；而micro bench可以定量的分析一台机器+操作系统的性能，采用相同的测试基准，通过无干扰的大量重复基本操作，比如从L1 Cache读取单个字节，耗时一个CPU时钟，在大量重复中得到较为宏观的结果，再排除loop损耗、取运行时间的损耗，可以用于基本衡量一台server的运行效率。</p>

<pre><code class="language-bash">./bin/x86_64-linux-gnu/enough

结果为n=322229, u=5172，执行322229次 TEN( p = *p )，

TEN(T)表示循环展开执行10次任务T，可使loop开销对单次执行结果的影响降低1/10；

总共用时5172000ns，单次平均0.623ns；CPU主频1999.830MHz，折合一个cycle 0.500ns，数据基本可信。
</code></pre>

<p>提升性能主要是把CPU喂饱，所有的性能都是从CPU的角度来衡量；内存读写快慢，单纯比较数据从内存的一个位置移动到另一个位置，这是设备厂商用来做广告用的，不是计算机系统来评估性能的；把数据从内存读到CPU，然后写到另一个地址，数据流经过CPU即是经过了计算机系统，测量这段时间才是有意义的。以数据流动为基础，其他的bench，比如pipe的性能，需要排除数据流动的时间，排除loop等时间，才是单纯pipe的带宽性能；比如context switch速度，在做bench时，需要用pipe来驱动切换进程，这里需要排除掉数据流动的时间，pipe通信的时间，其余开销时间，才是context switch的时间。</p>

<p>性能评估主要对CPU、memory、disk IO和network IO四个指标，从带宽和时延两个角度评估。</p>

<p>所谓带宽，不仅仅是硬件上的读写速度，而是数据从源头到达CPU，然后CPU将其送往目的地的速度，考验的是传输能力；所谓时延，更多的评估传输的效率，读取一定量的数据，数据可以在多长时间内从内存读取到CPU。</p>

<p>所谓时延，其实也是另一种意义的速度，比如context switch，并没有吞吐量这个概念，但是通过将多个进程切换N次，得到总体时间，平均后可以获得单次切换用时，用以评估context switch的latency。</p>

<h2 id="测试前的准备">测试前的准备</h2>

<p>很多很重要的选项，比如设计测试场景，从逻辑上说通一个测试中都包含哪些时间开销，如何测量</p>

<ul>
<li><p>测量数据块大小</p>

<ul>
<li>测量从内存经过CPU拷贝到另一块内存时，如果数据量过小，比如32KB，可能这个数据只在最次L2 Cache中流动，那么测量结果将会比真实数据大；如果数据量过大，又有可能被从内存换到磁盘上</li>
<li>为此的应对方法是，在循环中逐渐增大一倍数据量，列出不同数据量大小的测试数据，我们其实可以分辨出哪些是L1 Cache，哪些是Cache已经失效，因为他们之间的速度差异是巨大的；另外，当我们每次跨过一页访问该页内存，如果访问时间需要好几个us，那么说明这个内存页不在内存中</li>
</ul></li>

<li><p>测量时间</p>

<ul>
<li>不论用多么精确的时钟，由于benchmark时单次任务执行时间都非常短，因此用多次loop中求整体运行时间，取平均后能够得到误差较小的结果。</li>
<li>lmbench的时间机制写的很精妙，比如针对不同的任务，在每次bench的时候，都会预估执行当前任务执行比如500000us，需要执行多少次，这就是需要loop的次数；比较精妙，能够照顾到即使是相同计算机，在负载不一样的时候，对不同任务有一定的适应能力，在运行足够时间后使得系统表现稳定，得到稳定的结果；使用lmbench对相同任务做bench的时候，每次执行结果的误差都不大，低于2%，这个结果我想还是很稳定的。</li>
</ul></li>

<li><p>考虑多进程，以及编译器可能导致的问题</p>

<ul>
<li>测试时运行的benchmark也都比较小，其实可以视为和单处理器没有区别；或者我们可以将进程绑定到某个CPU上。</li>
<li>用gcc编译benchmark，优化级别为 -O，可以避免优化过度；注意一些load指令，如果load结果没有被用到的话，可能会被优化掉</li>
</ul></li>
</ul>

<h2 id="带宽性能测试">带宽性能测试</h2>

<ul>
<li><p>Memory: 数据从内存到CPU的带宽</p>

<ul>
<li>rd

<ul>
<li>单次读取512Byte数据，即128个int整数，并做相加操作以防止编译器优化；循环展开，而非在for中挨个相加</li>
<li>use_int(sum)等指令也是防止编译器优化的</li>
<li>每次读取512Byte，直到读完，算是一次读取完成</li>
<li>如果rd的数据块太小，比如32MB，很快被读完，这时需要调整连续循环读取iterations次，然后求平均；iterations的取值取决于根据系统负载情况，实时计算需要执行的次数。</li>
<li>我的CPU是<a href="http://www.cpu-world.com/CPUs/Xeon/Intel-Xeon%20E5-2620.html">至强E5-2620</a>，包含6*32KB的8路组相连数据L1缓存，6*256KB的8路组相连L2,15MB的20路共享L3cache</li>
<li>根据读取的数据块大小，我们可以逻辑上推断该数据处于哪级缓存；本机的L1/L2/L3分别为192kb/1536kb/15360kb，

<ul>
<li>数据块16KB，带宽34999.46MB/s</li>
<li>数据块32KB，带宽19191.28MB/s</li>
<li>数据块320KB，带宽10669.75MB/s</li>
<li>数据块8MB，带宽6394.37MB/s</li>
<li>数据块16MB，带宽4993.96MB/s</li>
<li>数据块1024MB，带宽4979.76MB/s

<ul>
<li>纯内存带宽</li>
</ul></li>
</ul></li>
</ul></li>
<li>wr

<ul>
<li>向内存块每一个4字节写入1</li>
</ul></li>
<li>rdwr

<ul>
<li>wr与rd的结合，性能略差
<br /></li>
</ul></li>
</ul></li>

<li><p>pipe：系统提供的IPC机制的带宽</p>

<ul>
<li>测量方式：父子进程阻塞读写pipe</li>
</ul></li>

<li><p>mmap方式读取文件：从磁盘文件读取数据的带宽</p>

<ul>
<li>mmap方式读取文件，首先要打开文件，然后通过mmap将fd映射到匿名内存页，mmap的内存页在读取时才会真正分配</li>
<li>测量方式：

<ul>
<li>一、多次循环中，open、mmap，然后读取内容，最后close</li>
<li>二、在测量前open文件，并进行mmap；在多次循环中，每次读取目标大小的文件数据；</li>
<li>前者可以得到通过读取文件数据时，mmap的纯开销；后者更贴近实际情况</li>
</ul></li>
<li>测量结果

<ul>
<li>读取1024m数据；测试采用-C标志，复制文件后再进行，可以以冷数据的方式避开文件缓存</li>
<li>结果一：3223.58 MB/s</li>
<li>结果二：7948.87 MB/s</li>
</ul></li>
</ul></li>

<li><p>read方式读取文件：从磁盘文件读取数据的带宽</p>

<ul>
<li>测量方式

<ul>
<li>一、以及包含open、read和close的带宽</li>
<li>二、测试单纯读文件(read)的带宽，</li>
</ul></li>
<li>测量结果

<ul>
<li>读取1024m数据；测试采用-C标志，复制文件后再进行，可以以冷数据的方式避开文件缓存</li>
<li>一、5526.29 MB/s</li>
<li>二、5442.29 MB/s
<br /></li>
</ul></li>
</ul></li>

<li><p>注：带宽测试中使用的计算机为 至强E5-2620；之后机器收回，我采用我的一台闲置笔记本Thinkpad X220进行时延性能测试，CPU为 i5-2520M</p></li>
</ul>

<h2 id="时延性能测试">时延性能测试</h2>

<p>计算机所有的时延几乎都跟memory时延有关，做context switch时首先要store当前进程状态，然后load下一个进程。可以说准确测量计算机内存时延是评估其他时延的前提，虽然内存时延的准确测量不太容易。</p>

<p>计算机系统中存在的时延主要有内存访问时延、调用操作系统组件如读写文件和系统调用等、进程创建的时延，以及进程切换导致的上下文切换时延。</p>

<h3 id="内存延时">内存延时</h3>

<ul>
<li><p>定义:</p>

<ul>
<li>刨去硬件相关的内存芯片和系统总线时延外，从总线和内存空闲时读数据，和连续读数据这两种场景的差异值得探讨。</li>
<li>总线空闲时读取内存数据

<ul>
<li>处理器等待从内存中取数据的时间

<ul>
<li>这个时间通常是一种标称值，有些处理器取数据时并不等待和停顿，因此测量延时可能显得小于标称值</li>
<li>而压测时，由于突发读取导致cache miss，导致实际延时又比这个值大</li>
<li>因此采用这个值也不是那么合理</li>
</ul></li>
</ul></li>
<li>连续繁忙读内存数据

<ul>
<li>连续读内存时，每次load都会跟着一个load。</li>
<li>连续读可能会导致时延高于空闲读，有些系统会有&rdquo;关键字优先&rdquo;的机制，读取某个字时不等待整个cache line填充就把该line中的要读取数据喂给CPU，然而此时cache依然处于busy状态；如果此时再有第二次load，会因为当前cache busy而停顿等待。在UltraSPARC中空闲读和连续读的差异可达35%.</li>
</ul></li>
<li>所以lmbench采用的是测试连续读时的内存时延，一来连续读的测量比空闲读容易些，二来连续读更贴近实际情况。由于处理器速度很快，即使发生cache miss，引起的load latency也和连续读更接近。</li>
</ul></li>

<li><p>测量原理</p>

<ul>
<li>采用不同内存大小、不同读取跨度stride来评估、探测系统的各级内存：L1、L2、L3以及主存的时延</li>
<li>读取内存，每跨读一步，如果跨度很小，比如64B/128B小于Cache line，那么时延会很小，如果跨度很大，比如1M，可能就需要从主存中将该地址内容读出，时延会相应增大</li>
<li><del>每次测量前先通过分配一块内存将cache内容全部替换掉</del></li>
<li>与bw_mem不同的是，并不读取数据块，而是通过地址链表跨stride去访问内存，以此测试内存时延，可见目的和测试bandwidth不一样

<ul>
<li>地址链表的实现方式是，比如512KB的内存块buf，编址从0开始，以512 Byte为一跳</li>
<li>buf = 0x77889900, buf + 512 = 0x77889b00</li>
<li>*buf = 0x77889b00，即用内存块存放下一跳地址，这个时候 buf = 0x77889900, *(long *)buf = 0x77889b00, buf[0] = 0x00, buf[1] = 0x9b等等</li>
<li>这个地址链表非常高效，因为我们不关心buf存放内容，所以就利用buf的空间来存储下一跳地址；类似于如下代码</li>
</ul></li>
<li>对一块内存进行跨行访问，依次采用不同大小内存和不同跨度，比如size=32KB，stride=512B，根据访问次数64次，和用时time，可以得出该次访问用时为time/64.</li>
<li>对于L1 Cache 32KB，L2 Cache 256KB和L3 Cache 3072KB来说，通过内存大小可以限定访问主要集中在哪级Cache，控制stride降低各级Cache miss，可以推断出访问时间。</li>
</ul></li>
</ul>

<pre><code class="language-cpp">
	char *buf = (char *)malloc(sizeof(char ) * 1024);
	memset(buf, 0, 1024);
	*(char **)&amp;(buf[0]) = (char *)&amp;(buf[512]);
	printf(&quot;%p\t%p\n&quot;, buf, buf + 512);
	char **p = (char *)&amp;buf[0];
	printf(&quot;%p\t%p\n&quot;, p, *p);

</code></pre>

<ul>
<li>测量结果

<ul>
<li>测量结果如下图所示，<a href="https://raw.githubusercontent.com/BG2BKK/githubio/master/static/lat_mem_latency.png">原图见</a>，原始数据<a href="https://github.com/BG2BKK/githubio/blob/master/static/data.set">见文件</a></li>
</ul></li>
</ul>

<div align="center"><img src="https://raw.githubusercontent.com/BG2BKK/githubio/master/static/lat_mem_latency.png" ><p>多级内存的读写速度，从L1、L2、L3到主存</p></div>

<pre><code>图例：
    横轴读取的内存块大小，从4KB到8MB，横轴以0.5MB为单位
    纵轴是load平均延迟，单位为ns，从1ns到50ns
    不同颜色的线表示不同的Stride，即每次读内存时跨越的数据长度
    系统L1 Cache 32KB、L2 Cache 256KB、L3 Cache 3072KB
    getconf命令可以获取系统的必要信息，包括各级Cache
</code></pre>

<ul>
<li>intel CPU的各级缓存latency的<a href="https://software.intel.com/sites/products/collateral/hpc/vtune/performance_analysis_guide.pdf">官方数据</a>和<a href="https://software.intel.com/en-us/forums/intel-manycore-testing-lab/topic/287236">其他解释</a></li>
</ul>

<pre><code class="language-bash">Core i7 Xeon 5500 Series

Data Source Latency (approximate)

L1 CACHE hit, ~4 cycles

L2 CACHE hit, ~10 cycles

L3 CACHE hit, line unshared ~40 cycles

L3 CACHE hit, shared line in another core ~65 cycles

L3 CACHE hit, modified in another core ~75 cycles

remote L3 CACHE ~100-300 cycles

Local Dram ~60 ns

Remote Dram ~100 ns

</code></pre>

<h4 id="对于测量各级cache的latency来说-需要对每级进行特定分析">对于测量各级Cache的latency来说，需要对每级进行特定分析。</h4>

<h5 id="l1-cache-latency">L1 Cache Latency</h5>

<p>对于intel i5-2520M来说，L1 Cache的32KB容量，cache line长64B，8路组相连，每路4KB大小，有64组cache line供选择；在不考虑其他因素的情况下，每32KB连续数据中一定会产生L1 miss，每4KB连续数据一定会有一次组内选择哪路cache line存储数据，可能产生cache miss；一旦产生cache miss，会进行L2乃至下一级的读取，造成时延加大，影响L1 cache的latency测量。因此为了避免cache miss带来的影响，在测量L1时尽量采用小步长，小内存块进行逼近，得到尽可能精确的L1 Cache的latency。</p>

<h5 id="l2-cache-latency">L2 Cache Latency</h5>

<p>对于L2 Cache来说，所用内存块和步长应该加大，尽量使L1 Cache失效，访问L2；也应该注意步长不能过大，造成L2 失效；所采用的内存块大小倒不是关键，因为即使再大的内存块也需要按照步长读取</p>

<h5 id="l3-cache-latency">L3 Cache Latency</h5>

<p>L3 Cache的latency反而难以测量，原因一是L3可能是多核共享的，容易受干扰，二是相比L1/L2和DRAM的性能差异，L3与DRAM的访问差异显得不那么大。此外，TLB的因素也应该考虑在内。</p>

<p>拜读完<a href="yuhaozhu.com/CacheMemory.pdf">CacheMemory.pdf</a>的第一章后，发现自己考虑的太少了，所以以上的测量方法其实只能说明一个大概，并不能极具说服力的得出时延数据就是L1 Latency。</p>

<h4 id="todo">TODO</h4>

<hr />

<ul>
<li>measure cache line</li>
<li>measure tlb</li>
<li><a href="https://lwn.net/Articles/252125/">lwn</a></li>
<li><a href="https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/W51a7ffcf4dfd_4b40_9d82_446ebc23c550/page/Untangling%20memory%20access%20measurements%20-%20memory%20latency">IBM关于lmbench对mem latency的深度benchmark</a></li>
<li><a href="http://stackoverflow.com/questions/4087280/approximate-cost-to-access-various-caches-and-main-memory">stackoverflow_1</a> <a href="http://stackoverflow.com/questions/10274355/cycles-cost-for-l1-cache-hit-vs-register-on-x86">stackoverflow_2</a></li>
<li>读内存过程

<ul>
<li><a href="http://yuhaozhu.com/CacheMemory.pdf">CPU读数据的一系列过程</a></li>
<li><a href="http://duartes.org/gustavo/blog/post/what-your-computer-does-while-you-wait/">What Your Computer Dos While You Wait</a></li>
<li><a href="http://www.cnblogs.com/xkfz007/archive/2012/10/08/2715163.html">译文</a></li>
<li><a href="https://software.intel.com/sites/default/files/m/1/1/7/0/a/12645-6.7__Cache_e7_9b_b8_e5_85_b3_e9_97_ae_e9_a2_98.pdf">intel: Cache相关的问题</a></li>
</ul></li>
</ul>

<h3 id="调用系统组件-系统调用">调用系统组件（系统调用）</h3>

<p>调用操作系统的入口，一般指系统调用，比如读写设备的read/write，比如getpid()或getimeofday()。</p>

<p>对于前者的bench，选择操作/dev/null设备，每次写一个字，一般为4字节，经历了用户进程发起系统调用、转入内核态、查询文件描述符、VFS层等一整个过程，测量这个过程的时间；选择该设备的原因是所有操作系统都没有对该设备进行优化</p>

<p>而后者，系统调用比如getpid、gettimeofday，各平台不同优化，甚至是实现在用户层，不过在Linux上仍然是实现在内核态的。所以可以通过getpid()了解基本开销，通过写/dev/null设备了解整体开销。</p>

<ul>
<li>原理：

<ul>
<li>在循环中调用getpid()和write(fd, *buf, 1)</li>
</ul></li>
<li>结果：

<ul>
<li>getpid<br />

<ul>
<li>Simple syscall: 0.0540 microseconds</li>
</ul></li>
<li>write to /dev/null

<ul>
<li>Simple write: 0.0897 microseconds</li>
</ul></li>
</ul></li>
</ul>

<h3 id="信号处理耗时">信号处理耗时</h3>

<ul>
<li><p>建立信号sigaction耗时</p>

<ul>
<li>测量原理：

<ul>
<li>在本进程内部，调用sigaction建立信号</li>
<li>time = sig_installation</li>
</ul></li>
<li>测量结果：

<ul>
<li>Signal handler installation: 0.1492 microseconds</li>
</ul></li>
</ul></li>

<li><p>发送信号耗时 kill(pid, sig)</p>

<ul>
<li>测量原理：

<ul>
<li>设置不捕获信号，进程内向自己发送信号，kill(pid_self, SIGUSR1)</li>
<li>time = sig_send</li>
</ul></li>
<li>测量结果：

<ul>
<li>0.1240 microseconds</li>
</ul></li>
</ul></li>

<li><p>捕获并处理信号耗时</p>

<ul>
<li>测量原理：

<ul>
<li>设置捕获信号，向自己发送信号，kill(pid_self, SIGUSR1)</li>
<li>sig_handle = total_time - sig_installation - sig_send</li>
</ul></li>
<li>测量结果：

<ul>
<li>Signal handler overhead: 0.9763 microseconds</li>
</ul></li>
</ul></li>

<li><p>捕获信号耗时：</p>

<ul>
<li>测量原理：

<ul>
<li>在bench进程中以只读方式mmap一段内存，如果试图写这块内存，则会一直触发SIGBUS和SIGSEGV信号</li>
<li>在触发信号前设置SIGBUS和SIGSEGV的处理函数，在处理函数中不执行任务，只动态调整捕获次数；捕获次数达到一定数量时，评估单次处理用时</li>
<li>由于重复捕获信号，并且信号处理函数里基本没有任务，可以认为这段时间是捕获信号耗时，或者说是信号传递耗时</li>
</ul></li>
<li>测量结果:

<ul>
<li>Protection fault: 0.4928 microseconds</li>
</ul></li>
</ul></li>

<li><p>补充：</p>

<ul>
<li>由于第三项与第四项采用不相同的测试场景测量，前三项是一个场景，进程设置信号捕获，并向自身发送信号，然后捕获处理，第四项是产生page fault后重复触发信号，bench程序统计捕获次数和耗时计算得来。</li>
</ul></li>
</ul>

<h3 id="创建进程开销">创建进程开销</h3>

<p>进程相关的benchmark主要是衡量几个进程原语：创建新进程、执行新的程序以及上下文切换。</p>

<ul>
<li>创建进程的开销：fork process

<ul>
<li>测量原理：

<ul>
<li>通过fork创建子进程，子进程直接执行exit退出；所以最后测量的时间是：fork() + exit()

<ul>
<li>其实这里的开销还包括了父进程调用wait系统调用和父子进程上下文切换的开销，前者在本机50ns、后者在本机1.93us，相对进程创建来说非常小</li>
</ul></li>
</ul></li>
<li>测量结果：

<ul>
<li>Process fork+exit: 107.1001 microseconds</li>
</ul></li>
</ul></li>
<li>创建进程并执行新程序的开销：fork + execlp

<ul>
<li>测量原理：

<ul>
<li>不光测量fork的时间开销，还要通过execlp系统调用加载新程序/tmp/hello，打印一条hello world信息</li>
</ul></li>
<li>测量结果：

<ul>
<li>Process fork+execve: 372.2349 microseconds</li>
</ul></li>
</ul></li>
</ul>

<h3 id="上下文切换的开销">上下文切换的开销</h3>

<ul>
<li><p>上下文切换会受到多个因素影响：切换进程数量、每个进程自身的内存大小，以及Cache在其中的影响</p></li>

<li><p>测量结果：</p></li>
</ul>

<h2 id="intel的超线程技术">intel的超线程技术</h2>

<p><a href="https://www.ibm.com/developerworks/cn/linux/l-htl/">CPU的超线程机制</a>通过复制、分区和共享 Intel NetBurst 微结构管道中的资源，使得一个物理处理器能包含两个逻辑处理器。逻辑处理器有自己的处理器状态、指令指针、重命名逻辑以及一些较小的资源，共享的资源有乱序执行引擎和高速缓存。超线程机制HT利用各资源的速度差异，在时间上并行模拟出两份计算资源，理论上讲提供多一倍的计算能力，而代价是，既然涉及到共享，那么在一些操作中会因为共享和竞争而有性能损耗。下表是超线程对Linux API的影响，采用lmbench测试结果，这份bench报表在运行有linux-2.4.19内核的Intel Xeon处理器上，主频1.60GHz。</p>

<p><h5 id="N100C0"> 超线程对 Linux API 的影响</h5>
<table border="1" cellpadding="5" cellspacing="1" class="ibm-data-table" summary=""><thead xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><th><strong>内核函数</strong></th><th><strong>2419s-noht</strong></th><th><strong>2419s-ht</strong></th><th><strong>加速</strong></th></tr></thead><tbody xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><td>简单的 syscall</td><td>1.10</td><td>1.10</td><td>0%</td></tr><tr><td>简单的 read</td><td>1.49</td><td>1.49</td><td>0%</td></tr><tr><td>简单的 write</td><td>1.40</td><td>1.40</td><td>0%</td></tr><tr><td>简单的 stat</td><td>5.12</td><td>5.14</td><td>0%</td></tr><tr><td>简单的 fstat</td><td>1.50</td><td>1.50</td><td>0%</td></tr><tr><td>简单的 open/close</td><td>7.38</td><td>7.38</td><td>0%</td></tr><tr><td>对 10 个 fd 的选择</td><td>5.41</td><td>5.41</td><td>0%</td></tr><tr><td>对 10 个 tcp fd 的选择</td><td>5.69</td><td>5.70</td><td>0%</td></tr><tr><td>信号处理程序安装</td><td>1.56</td><td>1.55</td><td>0%</td></tr><tr><td>信号处理程序开销</td><td>4.29</td><td>4.27</td><td>0%</td></tr><tr><td>管道延迟</td><td>11.16</td><td>11.31</td><td>-1%</td></tr><tr><td>进程 fork+exit</td><td>190.75</td><td>198.84</td><td>-4%</td></tr><tr><td>进程 fork+execve</td><td>581.55</td><td>617.11</td><td>-6%</td></tr><tr><td>进程 fork+/bin/sh -c</td><td>3051.28</td><td>3118.08</td><td>-2%</td></tr><tr><td colspan="4">注：数据用微秒表示：越小越好。</td></tr></tbody></table></p>

<p>我认为上表中，ht没有影响的API是一些lmbench单进程可以测试的项，比如read、write等，而ht有影响的选项，比如管道延迟、进程fork+exit等，是lmbench需要发起多个进程进行bench，这些进程在逻辑处理器间有竞争，导致性能有些下降。从报表中可以看到，开启ht的bench结果在有些项目中耗时加长，但是比较小，但是整个系统获得了一倍的计算资源。</p>

<h2 id="intel的turbo技术">intel的turbo技术</h2>

<p><a href="https://magiclen.org/linux-intel-cpu/">linux的睿频工具</a>可以实时看到CPU的运行频率</p>

<pre><code class="language-bash">sudo i7z
</code></pre>

<p>以笔记本CPU i5-2520M 为例，在CPU空闲时主频低至</p>

<pre><code class="language-bash">        Core [core-id]  :Actual Freq (Mult.)      C0%   Halt(C1)%  C3 %   C6 %  Temp      VCore
        Core 1 [0]:       1366.96 (13.72x)      24.9    81.6    4.69       0    62      1.1008
        Core 2 [2]:       1381.01 (13.86x)      23.3    79.2    7.89       0    62      1.1008
</code></pre>

<p>甚至更低</p>

<p>运行lmbench时，CPU满载，主频可达</p>

<pre><code class="language-bash">        Core [core-id]  :Actual Freq (Mult.)      C0%   Halt(C1)%  C3 %   C6 %  Temp      VCore
        Core 1 [0]:       2989.17 (30.00x)      16.9    73.4    6.37       0    69      1.1409
        Core 2 [2]:       3050.32 (30.61x)      99.1       0       0       0    73      1.1409
</code></pre>

<p>可见睿频的主要作用是动态调整CPU主频适应处理任务，当我们运行lmbench时，理所应当的CPU将会满载运行，所以计算CPU主频时完全不用担心睿频导致的频率变化，总是接近最高值的。</p>

<h2 id="lmbench测试框架">lmbench测试框架</h2>

<ul>
<li>fork出child进程，作为bench执行体；parent作为控制体；</li>
<li>parent和child通过pipe互相通信，child通知parent准备好，parent通知child开始，child执行完毕后通知parent完成；parent取完执行结果，通知child结束。</li>
<li>应用程序中child首先执行init程序，将准备工作做好；比如如果是bw_mem中的cp benchmark，需要首先分配好src内存块，然后分配dst内存块，准备好后即返回，init结束；</li>
<li>init结束后，benchmp框架进行下一步，while循环中执行benchmark进入warmup状态</li>
<li>child执行benchmark是以状态机方式实现的

<ul>
<li>首先是warmup状态，在该状态中childparent发送ready信号，阻塞等待parent的start信号。child收到start后，状态设置为timing_interval，取iterations为1，执行benchmark程序；执行完后重入while循环；</li>
<li>然后切换到timing_interval状态。由于之前在warmup状态执行以iterations为1的benchmark，重入循环时满足state-&gt;need_warmup == 0，所以开始统计上一次benchmark开始到现在的用时，并刨去t_overload和l_overload；进入状态机的timing_interval状态，该状态评估本次benchmark的用时是否符合期望，如果符合，将本次bench结果记录，并设置状态为cooldown；如果不符合期望，分情况，如果用时result小于150，说明单次benchmark用时太短，需要多次迭代得到总结果，因此将iterations扩大8倍去计算；如果用时大于150，说明单次benchmark执行时间是够的，但是需要微调迭代次数，按照 enough * 1.1 / (iterations / result)；所以说timing_interval状态是用来在bench过程中微调迭代次数以使执行时间符合预期的过程。</li>
<li>在cooldown状态，child阻塞等待取结果信号，并将结果写回response管道中；执行清理函数后，得到parent发出的exit信号，结束自己。</li>
</ul></li>
<li>最终结果存储在全局变量iterations和stop_tv中，其实是通过get_time()和get_n()，以及set_time()/save_n()或者set_results()中，并在用户程序的结束时进行计算。</li>
</ul>

    <div id="social-bar">
	<ul class="rrssb-buttons clearfix">
      <li class="email">
          <a href="mailto:?subject=%e6%80%8e%e6%a0%b7%e5%b0%bd%e5%8f%af%e8%83%bd%e5%85%a8%e9%9d%a2%e7%9a%84%e8%af%84%e4%bc%b0%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%9a%84%e6%80%a7%e8%83%bd&amp;body=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path transform="scale(0.014,-0.014) translate(0,-1670)" d="M1792 826v-794q0 -66 -47 -113t-113 -47h-1472q-66 0 -113 47t-47 113v794q44 -49 101 -87q362 -246 497 -345q57 -42 92.5 -65.5t94.5 -48t110 -24.5h1h1q51 0 110 24.5t94.5 48t92.5 65.5q170 123 498 345q57 39 100 87zM1792 1120q0 -79 -49 -151t-122 -123 q-376 -261 -468 -325q-10 -7 -42.5 -30.5t-54 -38t-52 -32.5t-57.5 -27t-50 -9h-1h-1q-23 0 -50 9t-57.5 27t-52 32.5t-54 38t-42.5 30.5q-91 64 -262 182.5t-205 142.5q-62 42 -117 115.5t-55 136.5q0 78 41.5 130t118.5 52h1472q65 0 112.5 -47t47.5 -113z"/>
                  </svg>
              </span>
              <span class="text">Email</span>
          </a>
      </li>
      <li class="facebook">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434 c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726 c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                  </svg>
              </span>
              <span class="text">Facebook</span>
          </a>
      </li>
			<li class="twitter">
          <a href="http://twitter.com/home?status=%e6%80%8e%e6%a0%b7%e5%b0%bd%e5%8f%af%e8%83%bd%e5%85%a8%e9%9d%a2%e7%9a%84%e8%af%84%e4%bc%b0%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%9a%84%e6%80%a7%e8%83%bd%20https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32 c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155 C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965 C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683 c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851 C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                  </svg>
              </span>
              <span class="text">Twitter</span>
          </a>
      </li>
			<li class="linkedin">
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/&amp;title=%e6%80%8e%e6%a0%b7%e5%b0%bd%e5%8f%af%e8%83%bd%e5%85%a8%e9%9d%a2%e7%9a%84%e8%af%84%e4%bc%b0%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%9a%84%e6%80%a7%e8%83%bd&amp;summary=%e7%bb%99%e4%bd%a0%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%ef%bc%8c%e6%80%8e%e6%a0%b7%e8%83%bd%e5%a4%9f%e5%85%a8%e9%9d%a2%e8%af%84%e4%bc%b0%e5%ae%83%e7%9a%84%e6%80%a7%e8%83%bd%ef%bc%9f%e9%9c%80%e8%a6%81%e6%b5%8b%e8%af%95%e5%93%aa%e4%ba%9b%e6%8c%87%e6%a0%87%ef%bc%9f%e8%af%b7%e5%86%99%e5%87%ba%e6%af%8f%e4%b8%aa%e6%8c%87%e6%a0%87%e7%9a%84%e5%85%b7%e4%bd%93%e6%b5%8b%e8%af%95%e5%8e%9f%e7%90%86%e5%92%8c%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81%e3%80%82%e5%81%87%e8%ae%be%e8%bf%99%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ae%8c%e5%85%a8%e5%a4%84%e4%ba%8e%e7%ba%bf%e4%b8%8b%e3%80%82%0a%e8%bf%99%e4%b8%aa%e9%97%ae%e9%a2%98%e7%9c%8b%e4%bc%bc%e5%b9%b3%e5%b8%b8%ef%bc%8c%e4%bd%86%e6%98%af%e7%bb%86%e7%bb%86%e5%ae%a1%e9%a2%98%e7%9a%84%e8%af%9d%ef%bc%8c%e5%8f%91%e7%8e%b0%e8%bf%98%e6%98%af%e4%b8%8d%e4%b8%80%e6%a0%b7%e7%9a%84%e3%80%82%e6%88%91%e4%bb%ac%e8%bf%87%e5%a4%9a%e5%85%b3%e6%b3%a8%e7%ba%bf%e4%b8%8a%e6%9c%ba%e5%99%a8%e7%9a%84%e6%80%a7%e8%83%bd%ef%bc%8c%e4%bd%86%e6%98%af%e5%a6%82%e6%9e%9c%e5%8d%95%e7%8b%ac%e6%8b%bf%e5%87%ba%e6%9d%a5%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%ef%bc%8c%e5%ae%83%e7%9a%84%e6%80%a7%e8%83%bd%e6%80%8e%e6%a0%b7%e5%91%a2%ef%bc%9f%0a%e8%af%84%e4%bc%b0%e5%92%8c%e5%8e%8b%e6%a6%a8%e4%b8%80%e5%8f%b0%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%80%a7%e8%83%bd%e7%9a%84%e8%af%9d%ef%bc%8c%e6%89%be%e5%88%b0%e8%af%84%e4%bc%b0%e7%9a%84%e6%8c%87%e6%a0%87%ef%bc%8c%e7%84%b6%e5%90%8e%e8%bf%9b%e8%a1%8c%e5%8e%8b%e6%b5%8b%e5%8a%a0%e8%a7%82%e5%af%9f%e7%9a%84%e6%96%b9%e5%bc%8f%ef%bc%8c%e5%be%97%e5%88%b0%e6%80%a7%e8%83%bd%e5%8f%82%e6%95%b0%e3%80%82%0a%20%e8%a7%82%e5%af%9f%e5%93%aa%e4%ba%9b%e6%8c%87%e6%a0%87%ef%bc%8c%e6%84%8f%e4%b9%89%e4%bd%95%e5%9c%a8%ef%bc%9f%20%e5%a6%82%e4%bd%95%e8%a7%82%e5%af%9f%e8%bf%99%e4%ba%9b%e6%8c%87%e6%a0%87%ef%bc%8c%e6%b5%8b%e8%af%95%e5%8e%9f%e7%90%86%ef%bc%8c%e8%a7%82%e6%b5%8b%e5%b7%a5%e5%85%b7%2f%e7%bb%9f%e8%ae%a1%e4%bb%a3%e7%a0%81%20%e5%a6%82%e4%bd%95%e8%bf%9b%e8%a1%8c%e5%8e%8b%e6%b5%8b%ef%bc%8c%e5%ae%9e%e7%8e%b0%e6%b5%8b%e8%af%95%e5%9c%ba%e6%99%af%ef%bc%8c%e5%8e%8b%e6%b5%8b%e5%b7%a5%e5%85%b7%2f%e5%8e%8b%e6%b5%8b%e4%bb%a3%e7%a0%81%20%20bench%e5%8f%af%e4%bb%a5%e5%88%86%e7%b1%bb%e4%b8%bamacro%20bench%e5%92%8cmicro%20bench%3b%e5%af%b9%e4%ba%8emacro%20bench%ef%bc%8c%e5%be%88%e5%a4%9a%e6%97%b6%e5%80%99%e6%88%91%e4%bb%ac%e5%be%97%e5%88%b0%e7%9a%84%e6%98%af%e4%b8%80%e4%b8%aa%e6%95%b4%e4%bd%93%e8%80%8c%e7%b2%97%e7%95%a5%e7%9a%84%e7%bb%93%e6%9e%9c%ef%bc%8c%e9%80%9a%e8%bf%87top%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%e7%b3%bb%e7%bb%9f%e8%b4%9f%e8%bd%bd%ef%bc%8c%e8%bf%99%e4%ba%9b%e5%af%b9%e4%ba%8e%e6%88%91%e4%bb%ac%e5%ae%9a%e4%bd%8d%e7%ba%bf%e4%b8%8a%e9%97%ae%e9%a2%98%ef%bc%8c%e5%88%86%e6%9e%90%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84%e6%80%a7%e8%83%bd%e7%83%ad%e7%82%b9%e5%be%88%e6%9c%89%e5%b8%ae%e5%8a%a9%ef%bc%8c%e7%84%b6%e8%80%8c%e8%bf%99%e5%b9%b6%e4%b8%8d%e8%83%bd%e7%b2%be%e7%a1%ae%e8%a1%a1%e9%87%8f%e4%b8%80%e5%8f%b0Linux%20Server%e7%9a%84%e6%80%a7%e8%83%bd%ef%bc%9b%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%a4%9a%e7%a7%8d%e5%a4%9a%e6%a0%b7%ef%bc%8c%e7%ba%bf%e4%b8%8a%e7%b3%bb%e7%bb%9f%e7%9b%ae%e7%9a%84%e5%90%84%e4%b8%8d%e7%9b%b8%e5%90%8c%ef%bc%8c%e6%89%80%e4%bb%a5macro%20bench%e4%b8%80%e8%88%ac%e7%94%a8%e4%ba%8ecase%20by%20case%e7%9a%84%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%ef%bc%8c%e7%94%a8%e4%ba%8e%e8%a7%a3%e5%86%b3%e5%ba%94%e7%94%a8%e7%9a%84%e6%80%a7%e8%83%bd%e7%93%b6%e9%a2%88%ef%bc%9b%e8%80%8cmicro%20bench%e5%8f%af%e4%bb%a5%e5%ae%9a%e9%87%8f%e7%9a%84%e5%88%86%e6%9e%90%e4%b8%80%e5%8f%b0%e6%9c%ba%e5%99%a8%2b%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%80%a7%e8%83%bd%ef%bc%8c%e9%87%87%e7%94%a8%e7%9b%b8%e5%90%8c%e7%9a%84%e6%b5%8b%e8%af%95%e5%9f%ba%e5%87%86%ef%bc%8c%e9%80%9a%e8%bf%87%e6%97%a0%e5%b9%b2%e6%89%b0%e7%9a%84%e5%a4%a7%e9%87%8f%e9%87%8d%e5%a4%8d%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%ef%bc%8c%e6%af%94%e5%a6%82%e4%bb%8eL1%20Cache%e8%af%bb%e5%8f%96%e5%8d%95%e4%b8%aa%e5%ad%97%e8%8a%82%ef%bc%8c%e8%80%97%e6%97%b6%e4%b8%80%e4%b8%aaCPU%e6%97%b6%e9%92%9f%ef%bc%8c%e5%9c%a8%e5%a4%a7%e9%87%8f%e9%87%8d%e5%a4%8d%e4%b8%ad%e5%be%97%e5%88%b0%e8%be%83%e4%b8%ba%e5%ae%8f%e8%a7%82%e7%9a%84%e7%bb%93%e6%9e%9c%ef%bc%8c%e5%86%8d%e6%8e%92%e9%99%a4loop%e6%8d%9f%e8%80%97%e3%80%81%e5%8f%96%e8%bf%90%e8%a1%8c%e6%97%b6%e9%97%b4%e7%9a%84%e6%8d%9f%e8%80%97%ef%bc%8c%e5%8f%af%e4%bb%a5%e7%94%a8%e4%ba%8e%e5%9f%ba%e6%9c%ac%e8%a1%a1%e9%87%8f%e4%b8%80%e5%8f%b0server%e7%9a%84%e8%bf%90%e8%a1%8c%e6%95%88%e7%8e%87%e3%80%82%0a.%2fbin%2fx86_64-linux-gnu%2fenough%20%e7%bb%93%e6%9e%9c%e4%b8%ban%3d322229%2c%20u%3d5172%ef%bc%8c%e6%89%a7%e8%a1%8c322229%e6%ac%a1%20TEN%28%20p%20%3d%20%2ap%20%29%ef%bc%8c%20TEN%28T%29%e8%a1%a8%e7%a4%ba%e5%be%aa%e7%8e%af%e5%b1%95%e5%bc%80%e6%89%a7%e8%a1%8c10%e6%ac%a1%e4%bb%bb%e5%8a%a1T%ef%bc%8c%e5%8f%af%e4%bd%bfloop%e5%bc%80%e9%94%80%e5%af%b9%e5%8d%95%e6%ac%a1%e6%89%a7%e8%a1%8c%e7%bb%93%e6%9e%9c%e7%9a%84%e5%bd%b1%e5%93%8d%e9%99%8d%e4%bd%8e1%2f10%ef%bc%9b%20%e6%80%bb%e5%85%b1%e7%94%a8%e6%97%b65172000ns%ef%bc%8c%e5%8d%95%e6%ac%a1%e5%b9%b3%e5%9d%870.623ns%ef%bc%9bCPU%e4%b8%bb%e9%a2%911999.830MHz%ef%bc%8c%e6%8a%98%e5%90%88%e4%b8%80%e4%b8%aacycle%200.500ns%ef%bc%8c%e6%95%b0%e6%8d%ae%e5%9f%ba%e6%9c%ac%e5%8f%af%e4%bf%a1%e3%80%82%20%20%e6%8f%90%e5%8d%87%e6%80%a7%e8%83%bd%e4%b8%bb%e8%a6%81%e6%98%af%e6%8a%8aCPU%e5%96%82%e9%a5%b1%ef%bc%8c%e6%89%80%e6%9c%89%e7%9a%84%e6%80%a7%e8%83%bd%e9%83%bd%e6%98%af%e4%bb%8eCPU%e7%9a%84%e8%a7%92%e5%ba%a6%e6%9d%a5%e8%a1%a1%e9%87%8f%ef%bc%9b%e5%86%85%e5%ad%98%e8%af%bb%e5%86%99%e5%bf%ab%e6%85%a2%ef%bc%8c%e5%8d%95%e7%ba%af%e6%af%94%e8%be%83%e6%95%b0%e6%8d%ae%e4%bb%8e%e5%86%85%e5%ad%98%e7%9a%84%e4%b8%80%e4%b8%aa%e4%bd%8d%e7%bd%ae%e7%a7%bb%e5%8a%a8%e5%88%b0%e5%8f%a6%e4%b8%80%e4%b8%aa%e4%bd%8d%e7%bd%ae%ef%bc%8c%e8%bf%99%e6%98%af%e8%ae%be%e5%a4%87%e5%8e%82%e5%95%86%e7%94%a8%e6%9d%a5%e5%81%9a%e5%b9%bf%e5%91%8a%e7%94%a8%e7%9a%84%ef%bc%8c%e4%b8%8d%e6%98%af%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%b3%bb%e7%bb%9f%e6%9d%a5%e8%af%84%e4%bc%b0%e6%80%a7%e8%83%bd%e7%9a%84%ef%bc%9b%e6%8a%8a%e6%95%b0%e6%8d%ae%e4%bb%8e%e5%86%85%e5%ad%98%e8%af%bb%e5%88%b0CPU%ef%bc%8c%e7%84%b6%e5%90%8e%e5%86%99%e5%88%b0%e5%8f%a6%e4%b8%80%e4%b8%aa%e5%9c%b0%e5%9d%80%ef%bc%8c%e6%95%b0%e6%8d%ae%e6%b5%81%e7%bb%8f%e8%bf%87CPU%e5%8d%b3%e6%98%af%e7%bb%8f%e8%bf%87%e4%ba%86%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%b3%bb%e7%bb%9f%ef%bc%8c%e6%b5%8b%e9%87%8f%e8%bf%99%e6%ae%b5%e6%97%b6%e9%97%b4%e6%89%8d%e6%98%af%e6%9c%89%e6%84%8f%e4%b9%89%e7%9a%84%e3%80%82%e4%bb%a5%e6%95%b0%e6%8d%ae%e6%b5%81%e5%8a%a8%e4%b8%ba%e5%9f%ba%e7%a1%80%ef%bc%8c%e5%85%b6%e4%bb%96%e7%9a%84bench%ef%bc%8c%e6%af%94%e5%a6%82pipe%e7%9a%84%e6%80%a7%e8%83%bd%ef%bc%8c%e9%9c%80%e8%a6%81%e6%8e%92%e9%99%a4%e6%95%b0%e6%8d%ae%e6%b5%81%e5%8a%a8%e7%9a%84%e6%97%b6%e9%97%b4%ef%bc%8c%e6%8e%92%e9%99%a4loop%e7%ad%89%e6%97%b6%e9%97%b4%ef%bc%8c%e6%89%8d%e6%98%af%e5%8d%95%e7%ba%afpipe%e7%9a%84%e5%b8%a6%e5%ae%bd%e6%80%a7%e8%83%bd%ef%bc%9b%e6%af%94%e5%a6%82context%20switch%e9%80%9f%e5%ba%a6%ef%bc%8c%e5%9c%a8%e5%81%9abench%e6%97%b6%ef%bc%8c%e9%9c%80%e8%a6%81%e7%94%a8pipe%e6%9d%a5%e9%a9%b1%e5%8a%a8%e5%88%87%e6%8d%a2%e8%bf%9b%e7%a8%8b%ef%bc%8c%e8%bf%99%e9%87%8c%e9%9c%80%e8%a6%81%e6%8e%92%e9%99%a4%e6%8e%89%e6%95%b0%e6%8d%ae%e6%b5%81%e5%8a%a8%e7%9a%84%e6%97%b6%e9%97%b4%ef%bc%8cpipe%e9%80%9a%e4%bf%a1%e7%9a%84%e6%97%b6%e9%97%b4%ef%bc%8c%e5%85%b6%e4%bd%99%e5%bc%80%e9%94%80%e6%97%b6%e9%97%b4%ef%bc%8c%e6%89%8d%e6%98%afcontext%20switch%e7%9a%84%e6%97%b6%e9%97%b4%e3%80%82%0a%e6%80%a7%e8%83%bd%e8%af%84%e4%bc%b0%e4%b8%bb%e8%a6%81%e5%af%b9CPU%e3%80%81memory%e3%80%81disk%20IO%e5%92%8cnetwork%20IO%e5%9b%9b%e4%b8%aa%e6%8c%87%e6%a0%87%ef%bc%8c%e4%bb%8e%e5%b8%a6%e5%ae%bd%e5%92%8c%e6%97%b6%e5%bb%b6%e4%b8%a4%e4%b8%aa%e8%a7%92%e5%ba%a6%e8%af%84%e4%bc%b0%e3%80%82%0a%e6%89%80%e8%b0%93%e5%b8%a6%e5%ae%bd%ef%bc%8c%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%af%e7%a1%ac%e4%bb%b6%e4%b8%8a%e7%9a%84%e8%af%bb%e5%86%99%e9%80%9f%e5%ba%a6%ef%bc%8c%e8%80%8c%e6%98%af%e6%95%b0%e6%8d%ae%e4%bb%8e%e6%ba%90%e5%a4%b4%e5%88%b0%e8%be%beCPU%ef%bc%8c%e7%84%b6%e5%90%8eCPU%e5%b0%86%e5%85%b6%e9%80%81%e5%be%80%e7%9b%ae%e7%9a%84%e5%9c%b0%e7%9a%84%e9%80%9f%e5%ba%a6%ef%bc%8c%e8%80%83%e9%aa%8c%e7%9a%84%e6%98%af%e4%bc%a0%e8%be%93%e8%83%bd%e5%8a%9b%ef%bc%9b%e6%89%80%e8%b0%93%e6%97%b6%e5%bb%b6%ef%bc%8c%e6%9b%b4%e5%a4%9a%e7%9a%84%e8%af%84%e4%bc%b0%e4%bc%a0%e8%be%93%e7%9a%84%e6%95%88%e7%8e%87%ef%bc%8c%e8%af%bb%e5%8f%96%e4%b8%80%e5%ae%9a%e9%87%8f%e7%9a%84%e6%95%b0%e6%8d%ae%ef%bc%8c%e6%95%b0%e6%8d%ae%e5%8f%af%e4%bb%a5%e5%9c%a8%e5%a4%9a%e9%95%bf%e6%97%b6%e9%97%b4%e5%86%85%e4%bb%8e%e5%86%85%e5%ad%98%e8%af%bb%e5%8f%96%e5%88%b0CPU%e3%80%82%0a%e6%89%80%e8%b0%93%e6%97%b6%e5%bb%b6%ef%bc%8c%e5%85%b6%e5%ae%9e%e4%b9%9f%e6%98%af%e5%8f%a6%e4%b8%80%e7%a7%8d%e6%84%8f%e4%b9%89%e7%9a%84%e9%80%9f%e5%ba%a6%ef%bc%8c%e6%af%94%e5%a6%82context%20switch%ef%bc%8c%e5%b9%b6%e6%b2%a1%e6%9c%89%e5%90%9e%e5%90%90%e9%87%8f%e8%bf%99%e4%b8%aa%e6%a6%82%e5%bf%b5%ef%bc%8c%e4%bd%86%e6%98%af%e9%80%9a%e8%bf%87%e5%b0%86%e5%a4%9a%e4%b8%aa%e8%bf%9b%e7%a8%8b%e5%88%87%e6%8d%a2N%e6%ac%a1%ef%bc%8c%e5%be%97%e5%88%b0%e6%80%bb%e4%bd%93%e6%97%b6%e9%97%b4%ef%bc%8c%e5%b9%b3%e5%9d%87%e5%90%8e%e5%8f%af%e4%bb%a5%e8%8e%b7%e5%be%97%e5%8d%95%e6%ac%a1%e5%88%87%e6%8d%a2%e7%94%a8%e6%97%b6%ef%bc%8c%e7%94%a8%e4%bb%a5%e8%af%84%e4%bc%b0context%20switch%e7%9a%84latency%e3%80%82%0a%e6%b5%8b%e8%af%95%e5%89%8d%e7%9a%84%e5%87%86%e5%a4%87%20%e5%be%88%e5%a4%9a%e5%be%88%e9%87%8d%e8%a6%81%e7%9a%84%e9%80%89%e9%a1%b9%ef%bc%8c%e6%af%94%e5%a6%82%e8%ae%be%e8%ae%a1%e6%b5%8b%e8%af%95%e5%9c%ba%e6%99%af%ef%bc%8c%e4%bb%8e%e9%80%bb%e8%be%91%e4%b8%8a%e8%af%b4%e9%80%9a%e4%b8%80%e4%b8%aa%e6%b5%8b%e8%af%95%e4%b8%ad%e9%83%bd%e5%8c%85%e5%90%ab%e5%93%aa%e4%ba%9b%e6%97%b6%e9%97%b4%e5%bc%80%e9%94%80%ef%bc%8c%e5%a6%82%e4%bd%95%e6%b5%8b%e9%87%8f%0a%20%e6%b5%8b%e9%87%8f%e6%95%b0%e6%8d%ae%e5%9d%97%e5%a4%a7%e5%b0%8f%0a%20%e6%b5%8b%e9%87%8f%e4%bb%8e%e5%86%85%e5%ad%98%e7%bb%8f%e8%bf%87CPU%e6%8b%b7%e8%b4%9d%e5%88%b0%e5%8f%a6%e4%b8%80%e5%9d%97%e5%86%85%e5%ad%98%e6%97%b6%ef%bc%8c%e5%a6%82%e6%9e%9c%e6%95%b0%e6%8d%ae%e9%87%8f%e8%bf%87%e5%b0%8f%ef%bc%8c%e6%af%94%e5%a6%8232KB%ef%bc%8c%e5%8f%af%e8%83%bd%e8%bf%99%e4%b8%aa%e6%95%b0%e6%8d%ae%e5%8f%aa%e5%9c%a8%e6%9c%80%e6%ac%a1L2%20Cache%e4%b8%ad%e6%b5%81%e5%8a%a8%ef%bc%8c%e9%82%a3%e4%b9%88%e6%b5%8b%e9%87%8f%e7%bb%93%e6%9e%9c%e5%b0%86%e4%bc%9a%e6%af%94%e7%9c%9f%e5%ae%9e%e6%95%b0%e6%8d%ae%e5%a4%a7%ef%bc%9b%e5%a6%82%e6%9e%9c%e6%95%b0%e6%8d%ae%e9%87%8f%e8%bf%87%e5%a4%a7%ef%bc%8c%e5%8f%88%e6%9c%89%e5%8f%af%e8%83%bd%e8%a2%ab%e4%bb%8e%e5%86%85%e5%ad%98%e6%8d%a2%e5%88%b0%e7%a3%81%e7%9b%98%e4%b8%8a%20%e4%b8%ba%e6%ad%a4%e7%9a%84%e5%ba%94%e5%af%b9%e6%96%b9%e6%b3%95%e6%98%af%ef%bc%8c%e5%9c%a8%e5%be%aa%e7%8e%af%e4%b8%ad%e9%80%90%e6%b8%90%e5%a2%9e%e5%a4%a7%e4%b8%80%e5%80%8d%e6%95%b0%e6%8d%ae%e9%87%8f%ef%bc%8c%e5%88%97%e5%87%ba%e4%b8%8d%e5%90%8c%e6%95%b0%e6%8d%ae%e9%87%8f%e5%a4%a7%e5%b0%8f%e7%9a%84%e6%b5%8b%e8%af%95%e6%95%b0%e6%8d%ae%ef%bc%8c%e6%88%91%e4%bb%ac%e5%85%b6%e5%ae%9e%e5%8f%af%e4%bb%a5%e5%88%86%e8%be%a8%e5%87%ba%e5%93%aa%e4%ba%9b%e6%98%afL1%20Cache%ef%bc%8c%e5%93%aa%e4%ba%9b%e6%98%afCache%e5%b7%b2%e7%bb%8f%e5%a4%b1%e6%95%88%ef%bc%8c%e5%9b%a0%e4%b8%ba%e4%bb%96%e4%bb%ac%e4%b9%8b%e9%97%b4%e7%9a%84%e9%80%9f%e5%ba%a6%e5%b7%ae%e5%bc%82%e6%98%af%e5%b7%a8%e5%a4%a7%e7%9a%84%ef%bc%9b%e5%8f%a6%e5%a4%96%ef%bc%8c%e5%bd%93%e6%88%91%e4%bb%ac%e6%af%8f%e6%ac%a1%e8%b7%a8%e8%bf%87%e4%b8%80%e9%a1%b5%e8%ae%bf%e9%97%ae%e8%af%a5%e9%a1%b5%e5%86%85%e5%ad%98%ef%bc%8c%e5%a6%82%e6%9e%9c%e8%ae%bf%e9%97%ae%e6%97%b6%e9%97%b4%e9%9c%80%e8%a6%81%e5%a5%bd%e5%87%a0%e4%b8%aaus%ef%bc%8c%e9%82%a3%e4%b9%88%e8%af%b4%e6%98%8e%e8%bf%99%e4%b8%aa%e5%86%85%e5%ad%98%e9%a1%b5%e4%b8%8d%e5%9c%a8%e5%86%85%e5%ad%98%e4%b8%ad%20%20%e6%b5%8b%e9%87%8f%e6%97%b6%e9%97%b4%0a%20%e4%b8%8d%e8%ae%ba%e7%94%a8%e5%a4%9a%e4%b9%88%e7%b2%be%e7%a1%ae%e7%9a%84%e6%97%b6%e9%92%9f%ef%bc%8c%e7%94%b1%e4%ba%8ebenchmark%e6%97%b6%e5%8d%95%e6%ac%a1%e4%bb%bb%e5%8a%a1%e6%89%a7%e8%a1%8c%e6%97%b6%e9%97%b4%e9%83%bd%e9%9d%9e%e5%b8%b8%e7%9f%ad%ef%bc%8c%e5%9b%a0%e6%ad%a4%e7%94%a8%e5%a4%9a%e6%ac%a1loop%e4%b8%ad%e6%b1%82%e6%95%b4%e4%bd%93%e8%bf%90%e8%a1%8c%e6%97%b6%e9%97%b4%ef%bc%8c%e5%8f%96%e5%b9%b3%e5%9d%87%e5%90%8e%e8%83%bd%e5%a4%9f%e5%be%97%e5%88%b0%e8%af%af%e5%b7%ae%e8%be%83%e5%b0%8f%e7%9a%84%e7%bb%93%e6%9e%9c%e3%80%82%20lmbench%e7%9a%84%e6%97%b6%e9%97%b4%e6%9c%ba%e5%88%b6%e5%86%99%e7%9a%84%e5%be%88%e7%b2%be%e5%a6%99%ef%bc%8c%e6%af%94%e5%a6%82%e9%92%88%e5%af%b9%e4%b8%8d%e5%90%8c%e7%9a%84%e4%bb%bb%e5%8a%a1%ef%bc%8c%e5%9c%a8%e6%af%8f%e6%ac%a1bench%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e9%83%bd%e4%bc%9a%e9%a2%84%e4%bc%b0%e6%89%a7%e8%a1%8c%e5%bd%93%e5%89%8d%e4%bb%bb%e5%8a%a1%e6%89%a7%e8%a1%8c%e6%af%94%e5%a6%82500000us%ef%bc%8c%e9%9c%80%e8%a6%81%e6%89%a7%e8%a1%8c%e5%a4%9a%e5%b0%91%e6%ac%a1%ef%bc%8c%e8%bf%99%e5%b0%b1%e6%98%af%e9%9c%80%e8%a6%81loop%e7%9a%84%e6%ac%a1%e6%95%b0%ef%bc%9b%e6%af%94%e8%be%83%e7%b2%be%e5%a6%99%ef%bc%8c%e8%83%bd%e5%a4%9f%e7%85%a7%e9%a1%be%e5%88%b0%e5%8d%b3%e4%bd%bf%e6%98%af%e7%9b%b8%e5%90%8c%e8%ae%a1%e7%ae%97%e6%9c%ba%ef%bc%8c%e5%9c%a8%e8%b4%9f%e8%bd%bd%e4%b8%8d%e4%b8%80%e6%a0%b7%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e5%af%b9%e4%b8%8d%e5%90%8c%e4%bb%bb%e5%8a%a1%e6%9c%89%e4%b8%80%e5%ae%9a%e7%9a%84%e9%80%82%e5%ba%94%e8%83%bd%e5%8a%9b%ef%bc%8c%e5%9c%a8%e8%bf%90%e8%a1%8c%e8%b6%b3%e5%a4%9f%e6%97%b6%e9%97%b4%e5%90%8e%e4%bd%bf%e5%be%97%e7%b3%bb%e7%bb%9f%e8%a1%a8%e7%8e%b0%e7%a8%b3%e5%ae%9a%ef%bc%8c%e5%be%97%e5%88%b0%e7%a8%b3%e5%ae%9a%e7%9a%84%e7%bb%93%e6%9e%9c%ef%bc%9b%e4%bd%bf%e7%94%a8lmbench%e5%af%b9%e7%9b%b8%e5%90%8c%e4%bb%bb%e5%8a%a1%e5%81%9abench%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e6%af%8f%e6%ac%a1%e6%89%a7%e8%a1%8c%e7%bb%93%e6%9e%9c%e7%9a%84%e8%af%af%e5%b7%ae%e9%83%bd%e4%b8%8d%e5%a4%a7%ef%bc%8c%e4%bd%8e%e4%ba%8e2%25%ef%bc%8c%e8%bf%99%e4%b8%aa%e7%bb%93%e6%9e%9c%e6%88%91%e6%83%b3%e8%bf%98%e6%98%af%e5%be%88%e7%a8%b3%e5%ae%9a%e7%9a%84%e3%80%82%20%20%e8%80%83%e8%99%91%e5%a4%9a%e8%bf%9b%e7%a8%8b%ef%bc%8c%e4%bb%a5%e5%8f%8a%e7%bc%96%e8%af%91%e5%99%a8%e5%8f%af%e8%83%bd%e5%af%bc%e8%87%b4%e7%9a%84%e9%97%ae%e9%a2%98%0a%20%e6%b5%8b%e8%af%95%e6%97%b6%e8%bf%90%e8%a1%8c%e7%9a%84benchmark%e4%b9%9f%e9%83%bd%e6%af%94%e8%be%83%e5%b0%8f%ef%bc%8c%e5%85%b6%e5%ae%9e%e5%8f%af%e4%bb%a5%e8%a7%86%e4%b8%ba%e5%92%8c%e5%8d%95%e5%a4%84%e7%90%86%e5%99%a8%e6%b2%a1%e6%9c%89%e5%8c%ba%e5%88%ab%ef%bc%9b%e6%88%96%e8%80%85%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e5%b0%86%e8%bf%9b%e7%a8%8b%e7%bb%91%e5%ae%9a%e5%88%b0%e6%9f%90%e4%b8%aaCPU%e4%b8%8a%e3%80%82%20%e7%94%a8gcc%e7%bc%96%e8%af%91benchmark%ef%bc%8c%e4%bc%98%e5%8c%96%e7%ba%a7%e5%88%ab%e4%b8%ba%20-O%ef%bc%8c%e5%8f%af%e4%bb%a5%e9%81%bf%e5%85%8d%e4%bc%98%e5%8c%96%e8%bf%87%e5%ba%a6%ef%bc%9b%e6%b3%a8%e6%84%8f%e4%b8%80%e4%ba%9bload%e6%8c%87%e4%bb%a4%ef%bc%8c%e5%a6%82%e6%9e%9cload%e7%bb%93%e6%9e%9c%e6%b2%a1%e6%9c%89%e8%a2%ab%e7%94%a8%e5%88%b0%e7%9a%84%e8%af%9d%ef%bc%8c%e5%8f%af%e8%83%bd%e4%bc%9a%e8%a2%ab%e4%bc%98%e5%8c%96%e6%8e%89%20%20%20%e5%b8%a6%e5%ae%bd%e6%80%a7%e8%83%bd%e6%b5%8b%e8%af%95%20%20Memory%3a%20%e6%95%b0%e6%8d%ae%e4%bb%8e%e5%86%85%e5%ad%98%e5%88%b0CPU%e7%9a%84%e5%b8%a6%e5%ae%bd%0a%20rd%20%20%e5%8d%95%e6%ac%a1%e8%af%bb%e5%8f%96512Byte%e6%95%b0%e6%8d%ae%ef%bc%8c%e5%8d%b3128%e4%b8%aaint%e6%95%b4%e6%95%b0%ef%bc%8c%e5%b9%b6%e5%81%9a%e7%9b%b8%e5%8a%a0%e6%93%8d%e4%bd%9c%e4%bb%a5%e9%98%b2%e6%ad%a2%e7%bc%96%e8%af%91%e5%99%a8%e4%bc%98%e5%8c%96%ef%bc%9b%e5%be%aa%e7%8e%af%e5%b1%95%e5%bc%80%ef%bc%8c%e8%80%8c%e9%9d%9e%e5%9c%a8for%e4%b8%ad%e6%8c%a8%e4%b8%aa%e7%9b%b8%e5%8a%a0%20use_int%28sum%29%e7%ad%89%e6%8c%87%e4%bb%a4%e4%b9%9f%e6%98%af%e9%98%b2%e6%ad%a2%e7%bc%96%e8%af%91%e5%99%a8%e4%bc%98%e5%8c%96%e7%9a%84%20%e6%af%8f%e6%ac%a1%e8%af%bb%e5%8f%96512Byte%ef%bc%8c%e7%9b%b4%e5%88%b0%e8%af%bb%e5%ae%8c%ef%bc%8c%e7%ae%97%e6%98%af%e4%b8%80%e6%ac%a1%e8%af%bb%e5%8f%96%e5%ae%8c%e6%88%90%20%e5%a6%82%e6%9e%9crd%e7%9a%84%e6%95%b0%e6%8d%ae%e5%9d%97%e5%a4%aa%e5%b0%8f%ef%bc%8c%e6%af%94%e5%a6%8232MB%ef%bc%8c%e5%be%88%e5%bf%ab%e8%a2%ab%e8%af%bb%e5%ae%8c%ef%bc%8c%e8%bf%99%e6%97%b6%e9%9c%80%e8%a6%81%e8%b0%83%e6%95%b4%e8%bf%9e%e7%bb%ad%e5%be%aa%e7%8e%af%e8%af%bb%e5%8f%96iterations%e6%ac%a1%ef%bc%8c%e7%84%b6%e5%90%8e%e6%b1%82%e5%b9%b3%e5%9d%87%ef%bc%9biterations%e7%9a%84%e5%8f%96%e5%80%bc%e5%8f%96%e5%86%b3%e4%ba%8e%e6%a0%b9%e6%8d%ae%e7%b3%bb%e7%bb%9f%e8%b4%9f%e8%bd%bd%e6%83%85%e5%86%b5%ef%bc%8c%e5%ae%9e%e6%97%b6%e8%ae%a1%e7%ae%97%e9%9c%80%e8%a6%81%e6%89%a7%e8%a1%8c%e7%9a%84%e6%ac%a1%e6%95%b0%e3%80%82%20%e6%88%91%e7%9a%84CPU%e6%98%af%e8%87%b3%e5%bc%baE5-2620%ef%bc%8c%e5%8c%85%e5%90%ab6%2a32KB%e7%9a%848%e8%b7%af%e7%bb%84%e7%9b%b8%e8%bf%9e%e6%95%b0%e6%8d%aeL1%e7%bc%93%e5%ad%98%ef%bc%8c6%2a256KB%e7%9a%848%e8%b7%af%e7%bb%84%e7%9b%b8%e8%bf%9eL2%2c15MB%e7%9a%8420%e8%b7%af%e5%85%b1%e4%ba%abL3cache%20%e6%a0%b9%e6%8d%ae%e8%af%bb%e5%8f%96%e7%9a%84%e6%95%b0%e6%8d%ae%e5%9d%97%e5%a4%a7%e5%b0%8f%ef%bc%8c%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e9%80%bb%e8%be%91%e4%b8%8a%e6%8e%a8%e6%96%ad%e8%af%a5%e6%95%b0%e6%8d%ae%e5%a4%84%e4%ba%8e%e5%93%aa%e7%ba%a7%e7%bc%93%e5%ad%98%ef%bc%9b%e6%9c%ac%e6%9c%ba%e7%9a%84L1%2fL2%2fL3%e5%88%86%e5%88%ab%e4%b8%ba192kb%2f1536kb%2f15360kb%ef%bc%8c%20%20%e6%95%b0%e6%8d%ae%e5%9d%9716KB%ef%bc%8c%e5%b8%a6%e5%ae%bd34999...." class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803 c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048 h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501 c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546 C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                  </svg>
              </span>
              <span class="text">LinkedIn</span>
          </a>
      </li>
      <li class="tumblr">
					<script>
						document.write('<a href="http://www.tumblr.com/share?v=3&amp;u=' + encodeURIComponent('https:\/\/bg2bkk.github.io\/post\/how%20to%20perform%20server%20performance%20evaluation\/') + '&amp;t=怎样尽可能全面的评估一台服务器的性能" class="popup">');
					</script>
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<path d="M18.02 21.842c-2.029 0.052-2.422-1.396-2.439-2.446v-7.294h4.729V7.874h-4.71V1.592c0 0-3.653 0-3.714 0 s-0.167 0.053-0.182 0.186c-0.218 1.935-1.144 5.33-4.988 6.688v3.637h2.927v7.677c0 2.8 1.7 6.7 7.3 6.6 c1.863-0.03 3.934-0.795 4.392-1.453l-1.22-3.539C19.595 21.6 18.7 21.8 18 21.842z"/>
									</svg>
              </span>
              <span class="text">Tumblr</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="reddit">
          <a href="http://www.reddit.com/submit?url=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/">
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<g>
													<path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
													<path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
													<path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 19.5 17.8 19.5 17.5 19.791z"/>
													<path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 C26.354 13.8 26.1 14.3 25.8 14.605z"/>
											</g>
									</svg>
              </span>
              <span class="text">Reddit</span>
          </a>
      </li>
      <li class="googleplus">
          <a href="https://plus.google.com/share?url=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <g>
                          <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663 c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027 C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068 c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562 c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41 c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511 c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478 c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492 c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479 c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"/>
                          <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004 23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89"/>
                      </g>
                  </svg>
              </span>
              <span class="text">Google+</span>
          </a>
      </li>
      <li class="pinterest">
          <script>
						var imgurl = "https:\/\/bg2bkk.github.io\/logo.png";
						var firstimg = document.getElementsByClassName("post")[0].getElementsByTagName("img")[0];
						if (firstimg !== undefined) {
							imgurl = firstimg.src;
						}
						document.write('<a href="http://pinterest.com/pin/create/button/?url=https:\/\/bg2bkk.github.io\/post\/how%20to%20perform%20server%20performance%20evaluation\/&amp;media=' + imgurl + '&amp;description=怎样尽可能全面的评估一台服务器的性能" class="popup">');
					</script>
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785 C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458 c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557 c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168 C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239 c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"/>
                  </svg>
              </span>
              <span class="text">Pinterest</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="pocket">
          <a href="https://getpocket.com/save?url=https://bg2bkk.github.io/post/how%20to%20perform%20server%20performance%20evaluation/"  class="popup">
              <span class="icon">
                  <svg width="32px" height="28px" viewBox="0 0 32 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                      <path d="M28.7817528,0.00172488695 C30.8117487,0.00431221738 31.9749312,1.12074529 31.9644402,3.10781507 C31.942147,6.67703739 32.1336065,10.2669583 31.8057648,13.8090137 C30.7147076,25.5813672 17.2181194,31.8996281 7.20714461,25.3808491 C2.71833574,22.4571656 0.196577202,18.3122624 0.0549495772,12.9357897 C-0.0342233715,9.5774348 0.00642900214,6.21519891 0.0300336062,2.85555035 C0.0405245414,1.1129833 1.21157517,0.0146615391 3.01995012,0.00819321302 C7.34746087,-0.00603710433 11.6775944,0.00431221738 16.0064164,0.00172488695 C20.2644248,0.00172488695 24.5237444,-0.00215610869 28.7817528,0.00172488695 L28.7817528,0.00172488695 Z M8.64885184,7.85611511 C7.38773662,7.99113854 6.66148108,8.42606978 6.29310958,9.33228474 C5.90114134,10.2969233 6.17774769,11.1421181 6.89875951,11.8276216 C9.35282156,14.161969 11.8108164,16.4924215 14.2976518,18.7943114 C15.3844131,19.7966007 16.5354102,19.7836177 17.6116843,18.7813283 C20.0185529,16.5495467 22.4070683,14.2982907 24.7824746,12.0327533 C25.9845979,10.8850542 26.1012707,9.56468083 25.1469132,8.60653379 C24.1361858,7.59255976 22.8449191,7.6743528 21.5890476,8.85191291 C19.9936451,10.3488554 18.3680912,11.8172352 16.8395462,13.3777945 C16.1342655,14.093159 15.7200114,14.0048744 15.0566806,13.3440386 C13.4599671,11.7484252 11.8081945,10.2060421 10.1262706,8.70001155 C9.65564653,8.27936164 9.00411403,8.05345704 8.64885184,7.85611511 L8.64885184,7.85611511 L8.64885184,7.85611511 Z"></path>
                  </svg>
              </span>
              <span class="text">Pocket</span>
          </a>
      </li>
  </ul>
</div>

    <div itemprop="author" itemscope itemtype="http://schema.org/Person">
  <h5>about the author</h5>
  <section>

	<p>如果关于本文您有兴趣，我们可以进一步探讨、交流和学习。我的email是 bg2bkk # gmail.com. 欢迎交流</p>
  </section>
</div>

    <div id="comments">
    
    
    
    
</div>

</article>

</main>
		<footer id="footer">
			<section id="footer-message">&copy; BG2BKK Site. All rights reserved. Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>. <a href="https://github.com/kathyqian/crisp-ghost-theme" target="_blank">Crisp</a> theme by <a href="http://kathyqian.com" target="_blank">Kathy Qian</a>.</section>
		</footer>

    <script>
      (function(c,f){asyncLoader=function(i,h){i.foreach(function(k,j){e(j,d(j),h)});if(typeof h.callback=="function"){var g=setInterval(function(){if(f.readyState==="complete"){clearInterval(g);h.callback()}},10)}};var d=function(g){var h=g.split(".");return h[h.length-1]},e=function(h,i,g){switch(i){case"js":a(h,g);break;case"css":b(h);break;default:break}},a=function(i,h){var g=document.createElement("script");g.type="text/javascript";g.async=true;g.src=i;document.getElementsByTagName("head")[0].appendChild(g)},b=function(g){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=g;document.getElementsByTagName("head")[0].appendChild(h)};Array.prototype.foreach=function(h){for(var g=0;g<this.length;g++){h(g,this[g])}}})(this,document);

      var WebFontConfig={google:{families:["Open Sans:300italic,700italic,300,700","Bree+Serif"]}};
      asyncLoader([
        "//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css",
        "//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js",
        "//cdnjs.cloudflare.com/ajax/libs/webfont/1.5.16/webfontloader.js",
        "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"
      ],{
        callback:function(){
          asyncLoader([
            "https:\/\/bg2bkk.github.io\/css/rrssb.css",
            "https:\/\/bg2bkk.github.io\/js/gist.min.js", 
            "https:\/\/bg2bkk.github.io\/js/rrssb.min.js",
            "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css"
          ], { callback:function() {
              hljs.initHighlighting();
          }});
        }
      });
    </script>
	
	</body>
</html>
